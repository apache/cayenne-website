<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.3">
        <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-touch-icon-04cb17e028.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32-12431ee8eb.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16-4f316e4d55.png">
        <link rel="manifest" href="/img/favicon/manifest-65e6aaa49e.json">
        <link rel="mask-icon" href="/img/favicon/safari-pinned-tab-558c1991b1.svg" color="#dc5656">
        <link rel="shortcut icon" href="/img/favicon/favicon-6cef91375b.ico">
        <meta name="msapplication-TileColor" content="#ffffff">
        <meta name="msapplication-TileImage" content="/img/favicon/mstile-144x144-34e7696278.png">
        <meta name="msapplication-config" content="/img/favicon/browserconfig-82ff158058.xml">
        <meta name="theme-color" content="#ffffff">
        <link rel="stylesheet" href="https://cayenne.apache.org/css/styles-179887de6c.css"/>
        <script src="https://cayenne.apache.org/js/bundle-bcaaf59313.js"></script>
        <title>Tutorial Object Relational Mapping &middot; Apache Cayenne</title>
    </head>
    <body data-spy="scroll" data-target=".toc-side" class="cd-head"> 
<header class="page-header">
    <nav id="topbar" class="bg-dark" aria-label="breadcrumb" role="navigation">
      <ul class="breadcrumb breadcrumb-sm breadcrumb-dark  container  mb-0">
        <li class="breadcrumb-item dropdown">
          <a class="dropdown-toggle  text-nowrap  pr-1" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <img class="mw-15px  mr-1" src="/img/feather-641aa69d09.svg" />Apache Software Foundation</a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="http://www.apache.org">Apache Homepage</a>
            <a class="dropdown-item" href="http://www.apache.org/licenses/">License</a>
            <a class="dropdown-item" href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
            <a class="dropdown-item" href="http://www.apache.org/foundation/thanks.html">Thanks</a>
            <a class="dropdown-item" href="http://www.apache.org/security/">Security</a>
          </div>
        </li>
        
      </ul>
    </nav>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container">
        <a class="navbar-brand" href="https://cayenne.apache.org/">
           <img src="/img/logo_mono_full-d7a19eef61.svg" alt="Apache Cayenne" />
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#mainMenu" aria-controls="mainMenu" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="mainMenu">
          <ul class="navbar-nav  mt-3 mt-lg-0 mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="/download/">DOWNLOAD</a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="/docs/4.0/getting-started-guide/">DOCUMENTATION</a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="/about/support/">SUPPORT</a>
            </li>
            
          </ul>
          <ul class="navbar-nav  flex-row justify-content-center  mt-2 mt-lg-0 mb-2 mb-lg-0 " id="social-links-menu">
            <li class="nav-item  d-flex">
              <a class="nav-link  d-flex justify-content-center align-items-center" href="https://github.com/apache/cayenne">
                <img src="/img/icon_octocat_stars-c24dac94b8.svg" alt="GitHub" /><span class="stargazers_count  ml-1l2"></span></a>
            </li>
            <li class="nav-item  d-flex">
              <a class="nav-link  d-flex justify-content-center align-items-center" href="https://twitter.com/ApacheCayenne">
                <img src="/img/icon_twitter-220a129d14.svg" alt="Twitter" />
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
</header>








<main>
    <div class="cd-top-sidebar  bb">
        <div class="container">
            <div class="row no-gutters">
                
                <div class="col-12 col-lg-4 col-xl-3  br  cd-sidebar1">
                    <ul class="nav" role="tablist">
                        <li class="nav-item dropdown mw-100">
                            <a class="nav-link dropdown-toggle text-truncate" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                                Cayenne Version 3.0
                            </a>
                            <div class="dropdown-menu">
                                <a class="dropdown-item" href="/docs/4.1/getting-started-guide/">Version 4.1 (Alpha)</a><a class="dropdown-item" href="/docs/4.0/getting-started-guide/">Version 4.0 (Beta)</a><a class="dropdown-item" href="/docs/3.1/getting-started-guide/">Version 3.1 (Stable)</a><a class="dropdown-item" href="/docs/3.0/cayenne-guide.html">Version 3.0 (Legacy)</a><a class="dropdown-item" href="/docs/2.0/user-guide.html">Version 2.0 (Legacy)</a><a class="dropdown-item" href="/docs/1.2/user-guide.html">Version 1.2 (Legacy)</a>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="col-12 col-lg-8 col-xl-9">  </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row no-gutters  ">
            <div class="col-12 col-lg-4 col-xl-3  br  py-2  bg-gray-100  cd-sidebar">
                <div class="tab-content" id="cd-docs-nav">
                    
                    <div class="cd-toc-item">
                        
                            <a class="cd-toc-link" href="/docs/3.0/cayenne-guide.html">Cayenne Guide</a>
                        
                    </div>
                    
                    <div class="cd-toc-item">
                        
                            <a class="cd-toc-link" href="/docs/3.0/modeler-guide.html">Modeler Guide</a>
                        
                    </div>
                    
                    <div class="cd-toc-item">
                        
                            <a class="cd-toc-link" href="/docs/3.0/remote-object-persistence-guide.html">Remote Object Persistence Guide</a>
                        
                    </div>
                    
                    <div class="cd-toc-item">
                        <a class="cd-toc-link" href="/docs/3.0/api/">JavaDoc</a>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-lg-8 col-xl-9  py-3 pl-lg-5  cd-content">

            
            <article>
                <section>
                    <P>The goal of this section is to learn how to create a simple Object-Relational model with CayenneModeler. We will create a complete ORM model for the following database schema:</P>

<P><SPAN class="image-wrap" style=""><img src="/docs/3.0/images/database-schema.jpg" style="border: 0px solid black"></SPAN></P>

<DIV class="panelMacro"><TABLE class="noteMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><img src="/docs/3.0/images/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>Very often you'd have an existing database already, and it can be quickly imported in Cayenne via <TT>&quot;Tools &gt; Reengineer Database Schema&quot;</TT>. This will save you lots of time compared to manual mapping. However understanding how to create the mapping by hand is important, so we are showing the &quot;manual&quot; approach below.</TD></TR></TABLE></DIV>

<H3><A name="TutorialObjectRelationalMapping-MappingDatabaseTablesandColumns"></A>Mapping Database Tables and Columns</H3>

<P>Lets go back to CayenneModeler where we have the newly created project open and start by adding the ARTIST table. Database tables are called <B>&quot;DbEntities&quot;</B> in Cayenne mapping (those can be actual tables or database views). </P>

<P>Select &quot;UntitledDomainMap&quot; on the left-hand side project tree and click &quot;Create DbEntity&quot; button (or use <TT>&quot;Project &gt; Create DbEntity&quot;</TT> menu). A new DbEntity is created. In &quot;DbEntity Name&quot; field enter &quot;ARTIST&quot;. Then click on &quot;Create Attribute&quot; button on the entity toolbar (third button from the left). This action changes the view to the &quot;Attribute&quot; tab and adds a new attribute (attribute means a &quot;table column&quot; in this case) called &quot;untitledAttr&quot;. Let's rename it to ID, make it an INTEGER and make it a PK:</P>

<P><SPAN class="image-wrap" style=""><img src="/docs/3.0/images/modeler-artistid.png" style="border: 0px solid black"></SPAN></P>

<P>Similarly add NAME VARCHAR(200) and DATE_OF_BIRTH DATE attributes.  After that repeat this procedure for PAINTING and GALLERY entities to match DB schema shown above.</P>

<DIV class="panelMacro"><TABLE class="noteMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><img src="/docs/3.0/images/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>Don't forget to save your project periodically to avoid losing your work. You will also have to refresh the project in Eclipse after every CayenneModeler save, as Eclipse is by default unaware of any changes made in the Modeler.</TD></TR></TABLE></DIV>

<H3><A name="TutorialObjectRelationalMapping-MappingDatabaseRelationships"></A>Mapping Database Relationships</H3>

<P>Now we need to specify relationships between ARTIST, PAINTING and GALLERY tables. Start by creating a one-to-many ARTIST/PAINTING relationship:</P>

<UL>
	<LI>Select the ARTIST DbEntity on the left and click on the &quot;Relationships&quot; tab.</LI>
	<LI>Click on &quot;Create Relationship&quot; button on the entity toolbar (second button from the left) - a relationship called &quot;untitledRel&quot; is created.</LI>
	<LI>Choose the &quot;Target&quot; to be &quot;Painting&quot;.</LI>
	<LI>Click on the &quot;Database Mapping&quot; button (letter &quot;I&quot; in a circle) - relationship configuration dialog is presented. Here you can assign a name to the relationship and also its complimentary reverse relationship. This name can be anything (this is really a symbolic name of the database referential constraint), but it is recommended to use a valid Java identifier, as this will save some typing later. We'll call the relationship &quot;paintings&quot; and reverse relationship &quot;artist&quot;.</LI>
	<LI>Click on &quot;Add&quot; button on the right to add a join</LI>
	<LI>Select &quot;ID&quot; column for the &quot;Source&quot; and &quot;ARTIST_ID&quot; column for the target.</LI>
	<LI>Relationship information should now look like this:</LI>
</UL>


<P><SPAN class="image-wrap" style=""><img src="/docs/3.0/images/modeler-dbrelationship.png" style="border: 0px solid black"></SPAN></P>

<UL>
	<LI>Click &quot;Done&quot; to confirm the changes and close the dialog.</LI>
	<LI>Two complimentary relationships have been created - from ARTIST to PAINTING and back. Still you may have noticed one thing is missing - &quot;paintings&quot; relationship should be to-many, but &quot;To Many&quot; checkbox is not checked. Let's change that - check the checkbox for &quot;paintings&quot; relationship, and then click on PAINTING DbEntity, and uncheck &quot;artist&quot; relationship &quot;To Many&quot; to make the reverse relationship &quot;to-one&quot; as it should be.</LI>
	<LI>Repeat the steps above to create a many-to-one relationship from PAINTING to GALLERY, calling the relationships pair &quot;gallery&quot; and &quot;paintings&quot;.</LI>
</UL>


<H3><A name="TutorialObjectRelationalMapping-MappingJavaClasses"></A>Mapping Java Classes</H3>

<P>Now that the database schema mapping is complete, CayenneModeler can create mappings of Java classes (aka &quot;ObjEntities&quot;) by deriving everything from DbEntities. At present there is no way to do it for the entire DataMap in one click, so we'll do it for each table individually.</P>

<UL>
	<LI>Select &quot;ARTIST&quot; DbEntity and click on &quot;Create ObjEntity&quot; button (a green class icon) either on the entity toolbar or on the main toolbar. An ObjEntity called &quot;Artist&quot; is created with a Java class field set to &quot;cayenne.tutorial.Artist&quot;. The modeler transformed the database names to the Java-friendly names (e.g., if you click on the &quot;Attributes&quot; tab, you'll see that &quot;DATE_OF_BIRTH&quot; column was converted to &quot;dateOfBirth&quot; Java class attribute).</LI>
	<LI>Select &quot;GALLERY&quot; DbEntity and click on &quot;Create ObjEntity&quot; button again - you'll see a &quot;Gallery&quot; ObjEntity created.</LI>
	<LI>Finally, do the same thing for &quot;PAINTING&quot;.</LI>
</UL>


<P>Now you need to synchronize relationships. Artist and Gallery entities were created when there was no related &quot;Painting&quot; entity, so their relationships were not set. </P>

<UL>
	<LI>Click on the &quot;Artist&quot; ObjEntity and (optinally) change to the &quot;Relationships&quot; tab. Now click on &quot;Sync ObjEntity with DbEntity&quot; button on the toolbar (two yellow arrows) - you will see the &quot;paintings&quot; relationship appear.</LI>
	<LI>Do the same for the &quot;Gallery&quot; entity.</LI>
</UL>


<P>Unless you want to customize the Java class and property names (which you can do easily) the mapping is complete. </P>

<HR>
<P><B>Next Step: <A href="tutorial-java-classes.html" title="Tutorial Java Classes">Tutorial Java Classes</A></B></P>
<HR>

                </section>
            </article>

	        </div>
	    </div>
	</div>
</main>

<footer class="bg-dark">
    <div class="footer-nav container  text-center text-lg-left  pb-3">
        <div class="row  pt-5 pb-3">
            
            <div class="col-sm-6 col-lg-3">
                <h4>About</h4>
                <ul class="list-unstyled">
                    
                    <li>
                        <a href="/why-cayenne.html">Why Cayenne?</a>
                    </li>
                    
                    <li>
                        <a href="/download/">Download</a>
                    </li>
                    
                    <li>
                        <a href="/success-stories.html">Success Stories</a>
                    </li>
                    
                    <li>
                        <a href="/about/support/">Support</a>
                    </li>
                    
                </ul>
            </div>
            
            <div class="col-sm-6 col-lg-3">
                <h4>Documentation</h4>
                <ul class="list-unstyled">
                    
                    <li>
                        <a href="/docs/4.0/getting-started-guide/">Getting Started (4.0)</a>
                    </li>
                    
                    <li>
                        <a href="/docs/4.1/getting-started-guide/">Getting Started (4.1)</a>
                    </li>
                    
                    <li>
                        <a href="/docs/4.0/cayenne-guide/">Cayenne Guide (4.0)</a>
                    </li>
                    
                    <li>
                        <a href="/docs/4.1/cayenne-guide/">Cayenne Guide (4.1)</a>
                    </li>
                    
                    <li>
                        <a href="/docs/4.1/getting-started-db-first/">Database First tutorial (4.1)</a>
                    </li>
                    
                </ul>
            </div>
            
            <div class="col-sm-6 col-lg-3">
                <h4>Collaboration</h4>
                <ul class="list-unstyled">
                    
                    <li>
                        <a href="https://issues.apache.org/jira/browse/CAY">Bug/Feature Tracker</a>
                    </li>
                    
                    <li>
                        <a href="/mailing-lists.html">Mailing Lists</a>
                    </li>
                    
                    <li>
                        <a href="/dev/code-repository.html">Code Repository</a>
                    </li>
                    
                    <li>
                        <a href="/dev/">Developer Guide</a>
                    </li>
                    
                    <li>
                        <a href="/how-can-i-help.html">How can I help?</a>
                    </li>
                    
                    <li>
                        <a href="/contributors.html">Contributors</a>
                    </li>
                    
                    <li>
                        <a href="/thanks.html">Thanks</a>
                    </li>
                    
                </ul>
            </div>
            
            <div class="col-sm-6 col-lg-3">
                <h4>News</h4>
                <ul class="list-multiline-items list-unstyled  mb-0">
                    
                    <li>
                        <time datetime="2017-11-20 12:00:00 &#43;0300 &#43;03" class="xsmall d-block">Nov 20, 2017</time>
                        <a href="/2017/11/cayenne-312-released.html">Cayenne 3.1.2 Released</a>
                    </li>
                    
                    <li>
                        <time datetime="2017-10-14 12:00:00 &#43;0300 &#43;03" class="xsmall d-block">Oct 14, 2017</time>
                        <a href="/2017/10/cayenne-41m1-released.html">Cayenne 4.1 Milestone 1 Released</a>
                    </li>
                    
                    <li>
                        <time datetime="2017-10-06 17:38:42 &#43;0300 &#43;03" class="xsmall d-block">Oct 06, 2017</time>
                        <a href="/2017/10/cayenne-40B2-released.html">Cayenne 4.0 Beta 2 Released</a>
                    </li>
                    
                </ul>
                <a class="btn-link text-uppercase xsmall" href="https://cayenne.apache.org/news">
                    More news
                    <i class="fa fa-lg fa-long-arrow-right" aria-hidden="true"></i>
                </a>
            </div>
        </div>
        <hr class="mt-0 mb-3" />
        <p class="copy xsmall text-center  mw-75 mx-auto mb-0">
            Copyright Â© 2001-2018 Apache Software Foundation. Apache Cayenne, Cayenne, Apache, the Apache feather logo, and the Apache Cayenne project logo are trademarks of The Apache Software Foundation. <a href="https://cayenne.apache.org/privacy-policy.html">Privacy policy</a>.
            <img class="d-block  mx-auto mt-2" src="/img/logo_mono-3302daa3cf.svg" alt="Apache Cayenne" />
        </p>
    </div>
</footer>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-7036673-1', 'auto');
ga('send', 'pageview');
</script>

    </body>
</html>
