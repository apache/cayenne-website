<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.3">
        <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-touch-icon-04cb17e028.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32-12431ee8eb.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16-4f316e4d55.png">
        <link rel="manifest" href="/img/favicon/manifest-65e6aaa49e.json">
        <link rel="mask-icon" href="/img/favicon/safari-pinned-tab-558c1991b1.svg" color="#dc5656">
        <link rel="shortcut icon" href="/img/favicon/favicon-6cef91375b.ico">
        <meta name="msapplication-TileColor" content="#ffffff">
        <meta name="msapplication-TileImage" content="/img/favicon/mstile-144x144-34e7696278.png">
        <meta name="msapplication-config" content="/img/favicon/browserconfig-82ff158058.xml">
        <meta name="theme-color" content="#ffffff">
        <link rel="stylesheet" href="https://cayenne.apache.org/css/styles-a216e88c4f.css"/>
        <script src="https://cayenne.apache.org/js/bundle-b017b6b604.js"></script>
        <title>Remote Object Persistence Tutorial Authentication &middot; Apache Cayenne</title>
    </head>
    <body data-spy="scroll" data-target=".toc-side" class="cd-head"> 
<header class="page-header">
    <nav id="topbar" class="bg-dark" aria-label="breadcrumb" role="navigation">
      <ul class="breadcrumb breadcrumb-sm breadcrumb-dark  container  mb-0">
        <li class="breadcrumb-item dropdown">
          <a class="dropdown-toggle  text-nowrap  pr-1" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <img class="mw-15px  mr-1" src="/img/feather-641aa69d09.svg" />Apache Software Foundation</a>
          <div class="dropdown-menu rounded-0" aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="https://www.apache.org">Apache Homepage</a>
            <a class="dropdown-item" href="https://www.apache.org/licenses/">License</a>
            <a class="dropdown-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
            <a class="dropdown-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a>
            <a class="dropdown-item" href="https://www.apache.org/security/">Security</a>
            <a class="dropdown-item" href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy</a>
            <a class="ml-1 mt-1 acevent" data-format="wide" data-mode="dark" data-width="120"></a>
          </div>
        </li>
      </ul>
    </nav>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container">
        <a class="navbar-brand" href="https://cayenne.apache.org/">
           <img src="/img/logo_mono_full-d7a19eef61.svg" alt="Apache Cayenne" />
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#mainMenu" aria-controls="mainMenu" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="mainMenu">
          <ul class="navbar-nav  mt-3 mt-lg-0 mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="/download/">DOWNLOAD</a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="/docs/4.1/getting-started-guide/">DOCUMENTATION</a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="/about/support/">SUPPORT</a>
            </li>
            
          </ul>
          <ul class="navbar-nav  flex-row justify-content-center  mt-2 mt-lg-0 mb-2 mb-lg-0 " id="social-links-menu">
            <li class="nav-item  d-flex">
              <a class="nav-link  d-flex justify-content-center align-items-center" href="https://github.com/apache/cayenne">
                <img src="/img/icon_octocat_stars-c24dac94b8.svg" alt="GitHub" />
              </a>
            </li>
            <li class="nav-item  d-flex">
              <a class="nav-link  d-flex justify-content-center align-items-center" href="https://twitter.com/ApacheCayenne">
                <img src="/img/icon_twitter-220a129d14.svg" alt="Twitter" />
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
</header>








<main>
    <div class="cd-top-sidebar  bb">
        <div class="container">
            <div class="row no-gutters">
                
                <div class="col-12 col-lg-4 col-xl-3  br  cd-sidebar1">
                    <ul class="nav" role="tablist">
                        <li class="nav-item dropdown mw-100">
                            <a class="nav-link dropdown-toggle text-truncate" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                                Cayenne Version 2.0
                            </a>
                            <div class="dropdown-menu">
                                <a class="dropdown-item" href="/docs/4.2/getting-started-guide/">Version 4.2 (Stable)</a><a class="dropdown-item" href="/docs/4.1/getting-started-guide/">Version 4.1 (Stable)</a><a class="dropdown-item" href="/docs/4.0/getting-started-guide/">Version 4.0 (Aging)</a><a class="dropdown-item" href="/docs/3.1/getting-started-guide/">Version 3.1 (Legacy)</a><a class="dropdown-item" href="/docs/3.0/cayenne-guide.html">Version 3.0 (Legacy)</a><a class="dropdown-item" href="/docs/2.0/user-guide.html">Version 2.0 (Legacy)</a><a class="dropdown-item" href="/docs/1.2/user-guide.html">Version 1.2 (Legacy)</a>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="col-12 col-lg-8 col-xl-9">  </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row no-gutters  ">
            <div class="col-12 col-lg-4 col-xl-3  br  py-2  bg-gray-100  cd-sidebar">
                <div class="tab-content" id="cd-docs-nav">
                    
                    <div class="cd-toc-item">
                        
                            <a class="cd-toc-link" href="/docs/2.0/user-guide.html">User Guide</a>
                        
                    </div>
                    
                    <div class="cd-toc-item">
                        
                            <a class="cd-toc-link" href="/docs/2.0/modeler-guide.html">Modeler Guide</a>
                        
                    </div>
                    
                    <div class="cd-toc-item">
                        
                            <a class="cd-toc-link" href="/docs/2.0/remote-object-persistence-guide.html">Remote Object Persistence Guide</a>
                        
                    </div>
                    
                    <div class="cd-toc-item">
                        <a class="cd-toc-link" href="/docs/2.0/api/">JavaDoc</a>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-lg-8 col-xl-9  py-3 pl-lg-5  cd-content">

            
            <article>
                <section>
                    
	
<P>You probably don't want everybody in the world to connect to your service and access (and update!) arbitrary data. The first step in securing Cayenne service is implementing client authentication. The easiest way to do it is to delegate the authentication task to the web container that is running the service. HessianConnection used in the <A href="remote-object-persistence-tutorial-client-code.html" title="Remote Object Persistence Tutorial Client Code">previous chapter</A> supports such authentication on the client side.</P>

<H3><A name="RemoteObjectPersistenceTutorialAuthentication-ConfiguringJettyLauncher"></A>Configuring JettyLauncher</H3>

<P>First we need to setup support for BASIC authentication in Jetty. </P>

<UL>
	<LI>In <TT>cayenne-tutorial</TT> project folder create a file called <TT>&quot;jetty-realm.properties&quot;</TT> with the following line of text:</LI>
</UL>


<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>cayenne-user: secret,cayenne-service-user</PRE>
</DIV></DIV>

<P>This file will store our user database. In each line the first word is a user name, the second - password, the rest are the roles of this user. So we've created a single user with login id &quot;cayenne-user&quot;, password &quot;secret&quot; and &quot;cayenne-service-user&quot; role.</P>

<UL>
	<LI>In the same folder create another file called &quot;jetty-run-config.xml&quot; with the following contents:</LI>
</UL>


<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>jetty-run-config.xml</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-java">&lt;?xml version=<SPAN class="code-quote">&quot;1.0&quot;</SPAN>  encoding=<SPAN class="code-quote">&quot;UTF-8&quot;</SPAN>?&gt;
&lt;!DOCTYPE Configure PUBLIC <SPAN class="code-quote">&quot;-<SPAN class="code-comment">//Mort Bay Consulting//DTD Configure//EN&quot;</SPAN> <SPAN class="code-quote">&quot;http://jetty.mortbay.org/configure.dtd&quot;</SPAN>&gt;
</SPAN>
&lt;Configure class=<SPAN class="code-quote">&quot;org.mortbay.jetty.Server&quot;</SPAN>&gt;

    &lt;Call name=<SPAN class="code-quote">&quot;addListener&quot;</SPAN>&gt;
        &lt;Arg&gt;
            &lt;New class=<SPAN class="code-quote">&quot;org.mortbay.http.SocketListener&quot;</SPAN>&gt;
                &lt;Set name=<SPAN class="code-quote">&quot;Port&quot;</SPAN>&gt;&lt;SystemProperty name=<SPAN class="code-quote">&quot;jetty.port&quot;</SPAN> <SPAN class="code-keyword">default</SPAN>=<SPAN class="code-quote">&quot;8080&quot;</SPAN>/&gt;
                &lt;/Set&gt;
                &lt;Set name=<SPAN class="code-quote">&quot;MinThreads&quot;</SPAN>&gt;2&lt;/Set&gt;
                &lt;Set name=<SPAN class="code-quote">&quot;MaxThreads&quot;</SPAN>&gt;100&lt;/Set&gt;
                &lt;Set name=<SPAN class="code-quote">&quot;MaxIdleTimeMs&quot;</SPAN>&gt;30000&lt;/Set&gt;
                &lt;Set name=<SPAN class="code-quote">&quot;LowResourcePersistTimeMs&quot;</SPAN>&gt;5000&lt;/Set&gt;
                &lt;Set name=<SPAN class="code-quote">&quot;PoolName&quot;</SPAN>&gt;Listener&lt;/Set&gt;
                &lt;Set name=<SPAN class="code-quote">&quot;ConfidentialPort&quot;</SPAN>&gt;8443&lt;/Set&gt;
                &lt;Set name=<SPAN class="code-quote">&quot;IntegralPort&quot;</SPAN>&gt;8443&lt;/Set&gt;
            &lt;/New&gt;
        &lt;/Arg&gt;
    &lt;/Call&gt;

    &lt;Set name=<SPAN class="code-quote">&quot;WebApplicationConfigurationClassNames&quot;</SPAN>&gt;
        &lt;Array type=<SPAN class="code-quote">&quot;java.lang.<SPAN class="code-object">String</SPAN>&quot;</SPAN>&gt;
            &lt;Item&gt;org.mortbay.jetty.servlet.XMLConfiguration&lt;/Item&gt;
        &lt;/Array&gt;
    &lt;/Set&gt;
	
    &lt;Call name=<SPAN class="code-quote">&quot;addRealm&quot;</SPAN>&gt;
        &lt;Arg&gt;
            &lt;New class=<SPAN class="code-quote">&quot;org.mortbay.http.HashUserRealm&quot;</SPAN>&gt;
                &lt;Arg&gt;Cayenne Realm&lt;/Arg&gt;
                &lt;Arg&gt;&lt;SystemProperty name=<SPAN class="code-quote">&quot;user.dir&quot;</SPAN> <SPAN class="code-keyword">default</SPAN>=<SPAN class="code-quote">&quot;.&quot;</SPAN>/&gt;/jetty-realm.properties&lt;/Arg&gt;
            &lt;/New&gt;
        &lt;/Arg&gt;
    &lt;/Call&gt;

    &lt;Call name=<SPAN class="code-quote">&quot;addWebApplication&quot;</SPAN>&gt;
        &lt;Arg&gt;/&lt;/Arg&gt;
        &lt;Arg&gt;webapp&lt;/Arg&gt;
    &lt;/Call&gt;
&lt;/Configure&gt;</PRE>
</DIV></DIV>

<P>This file is a Jetty-specific descriptor that emulates your existing JettyLauncher setup with one extra twist - an authentication realm.</P>

<UL>
	<LI>In Eclipse go to <TT>&quot;Run &gt; Run...&quot;</TT> and select &quot;cayenne-tutorial&quot; Jetty configuration.</LI>
	<LI>Select a &quot;Use a Jetty XML Configuration File&quot; radio button and navigate to &quot;jetty-run-config.xml&quot; file that we just created:</LI>
</UL>


<P><SPAN class="image-wrap" style=""><img src="/docs/2.0/images/custom-jetty.jpg" style="border: 0px solid black"></SPAN></P>

<UL>
	<LI>Click &quot;Apply&quot; and close the dialog.</LI>
</UL>


<P>As you may have guessed the procedure above is Jetty-specific and will be different on other servers (such as Tomcat) or with other authentication mechanisms (such as database realms).</P>

<H3><A name="RemoteObjectPersistenceTutorialAuthentication-ConfiguringSecurityConstraints"></A>Configuring Security Constraints</H3>

<UL>
	<LI>open <TT>web.xml</TT> and add security constraints for the web service, just like you would do in a normal web application. The following XML has to be added just before 	the closing &quot;web-app&quot; tag:</LI>
</UL>


<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>&quot;web.xml&quot;</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-java">    
    &lt;security-constraint&gt;
        &lt;web-resource-collection&gt;
            &lt;web-resource-name&gt;CayenneService&lt;/web-resource-name&gt;
            &lt;url-pattern&gt;/cayenne-service&lt;/url-pattern&gt;
        &lt;/web-resource-collection&gt;
        &lt;auth-constraint&gt;
            &lt;role-name&gt;cayenne-service-user&lt;/role-name&gt;
        &lt;/auth-constraint&gt;
    &lt;/security-constraint&gt;
    
    &lt;login-config&gt;
        &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
        &lt;realm-name&gt;Cayenne Realm&lt;/realm-name&gt;
    &lt;/login-config&gt;
	
    &lt;security-role&gt;
        &lt;role-name&gt;cayenne-service-user&lt;/role-name&gt;
    &lt;/security-role&gt;</PRE>
</DIV></DIV>

<UL>
	<LI>Save the file, shut down and restart the server and try to run the client. This time you should get an exception similar to this one:</LI>
</UL>


<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>Exception in thread &quot;main&quot; org.apache.cayenne.CayenneRuntimeException: [v.2.0.1 September 23 2006] Error establishing remote session. URL - http://localhost:8080/cayenne-service
	at org.apache.cayenne.remote.hessian.HessianConnection.connect(HessianConnection.java:257)
	at org.apache.cayenne.remote.hessian.HessianConnection.getServerEventBridge(HessianConnection.java:147)
	at org.apache.cayenne.remote.ClientChannel.setupRemoteChannelListener(ClientChannel.java:254)
	at org.apache.cayenne.remote.ClientChannel.&lt;init&gt;(ClientChannel.java:115)
	at org.apache.cayenne.remote.ClientChannel.&lt;init&gt;(ClientChannel.java:105)
	at org.apache.cayenne.remote.ClientChannel.&lt;init&gt;(ClientChannel.java:101)</PRE>
</DIV></DIV>

<UL>
	<LI>Go to the client Main class, and change the line that creates ClientConnection to take user name and password:</LI>
</UL>


<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>Main.java</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-java">ClientConnection connection = <SPAN class="code-keyword">new</SPAN> HessianConnection(<SPAN class="code-quote">&quot;http:<SPAN class="code-comment">//localhost:8080/cayenne-service&quot;</SPAN>, 
</SPAN>   <SPAN class="code-quote">&quot;cayenne-user&quot;</SPAN>,
   <SPAN class="code-quote">&quot;secret&quot;</SPAN>, 
   <SPAN class="code-keyword">null</SPAN>);</PRE>
</DIV></DIV>

<P>Now if you start the client again, it should successfully connect to the server and print the output similar to what <A href="remote-object-persistence-tutorial-client-code.html" title="Remote Object Persistence Tutorial Client Code">we've seen before</A>. Of course in a real application you might want secure the autentication with SSL. The technique above still applies, but you'll need to do some setup on the server. Consult your server documentation on how to enable HTTPS. On the client you would simply replace &quot;http://&quot; with &quot;https://&quot; in the server URL.</P>

<P>You are done with the tutorial!</P>


                </section>
            </article>


<img referrerpolicy="no-referrer-when-downgrade" src="https://static.scarf.sh/a.png?x-pxid=5c836e39-be6b-4a21-a946-a97b5b69f172" />
	        </div>
	    </div>
	</div>
</main>

<footer class="bg-dark">
    <div class="footer-nav container  text-center text-lg-left  pb-3">
        <div class="row  pt-5 pb-3">
            
            <div class="col-sm-6 col-lg-3">
                <h4>About</h4>
                <ul class="list-unstyled">
                    
                    <li>
                        <a href="/why-cayenne.html">Why Cayenne?</a>
                    </li>
                    
                    <li>
                        <a href="/download/">Download</a>
                    </li>
                    
                    <li>
                        <a href="/success-stories.html">Success Stories</a>
                    </li>
                    
                    <li>
                        <a href="/about/support/">Support</a>
                    </li>
                    
                </ul>
            </div>
            
            <div class="col-sm-6 col-lg-3">
                <h4>Documentation</h4>
                <ul class="list-unstyled">
                    
                    <li>
                        <a href="/docs/4.0/getting-started-guide/">Getting Started (4.0)</a>
                    </li>
                    
                    <li>
                        <a href="/docs/4.1/getting-started-guide/">Getting Started (4.1)</a>
                    </li>
                    
                    <li>
                        <a href="/docs/4.2/getting-started-guide/">Getting Started (4.2)</a>
                    </li>
                    
                    <li>
                        <a href="/docs/4.0/cayenne-guide/">Cayenne Guide (4.0)</a>
                    </li>
                    
                    <li>
                        <a href="/docs/4.1/cayenne-guide/">Cayenne Guide (4.1)</a>
                    </li>
                    
                    <li>
                        <a href="/docs/4.2/cayenne-guide/">Cayenne Guide (4.2)</a>
                    </li>
                    
                    <li>
                        <a href="/docs/4.1/getting-started-db-first/">Database First tutorial (4.1)</a>
                    </li>
                    
                    <li>
                        <a href="/docs/4.2/getting-started-db-first/">Database First tutorial (4.2)</a>
                    </li>
                    
                </ul>
            </div>
            
            <div class="col-sm-6 col-lg-3">
                <h4>Collaboration</h4>
                <ul class="list-unstyled">
                    
                    <li>
                        <a href="https://issues.apache.org/jira/browse/CAY">Bug/Feature Tracker</a>
                    </li>
                    
                    <li>
                        <a href="/mailing-lists.html">Mailing Lists</a>
                    </li>
                    
                    <li>
                        <a href="/dev/code-repository.html">Code Repository</a>
                    </li>
                    
                    <li>
                        <a href="/dev/">Developer Guide</a>
                    </li>
                    
                    <li>
                        <a href="/how-can-i-help.html">How can I help?</a>
                    </li>
                    
                    <li>
                        <a href="/contributors.html">Contributors</a>
                    </li>
                    
                    <li>
                        <a href="/thanks.html">Thanks</a>
                    </li>
                    
                </ul>
            </div>
            
            <div class="col-sm-6 col-lg-3">
                <h4>News</h4>
                <ul class="list-multiline-items list-unstyled  mb-0">
                    
                    <li>
                        <time datetime="2023-05-25 18:00:00 &#43;0300 &#43;0300" class="xsmall d-block">May 25, 2023</time>
                        <a href="/2023/05/cayenne-42-final-released/">Cayenne 4.2 Final Released</a>
                    </li>
                    
                    <li>
                        <time datetime="2023-03-02 12:00:00 &#43;0300 &#43;0300" class="xsmall d-block">Mar 02, 2023</time>
                        <a href="/2023/03/cayenne-403-released/">Cayenne 4.0.3 Released</a>
                    </li>
                    
                    <li>
                        <time datetime="2022-12-05 12:00:00 &#43;0300 &#43;0300" class="xsmall d-block">Dec 05, 2022</time>
                        <a href="/2022/12/cayenne-42rc2-released/">Cayenne 4.2 Release Candidate 2 Released</a>
                    </li>
                    
                </ul>
                <a class="btn-link text-uppercase xsmall" href="https://cayenne.apache.org/news">
                    More news
                    <i class="fa fa-lg fa-long-arrow-right" aria-hidden="true"></i>
                </a>
            </div>
        </div>
        <hr class="mt-0 mb-3" />
        <p class="copy xsmall text-center  mw-75 mx-auto mb-0">
            Copyright © 2001-2024 Apache Software Foundation. Apache Cayenne, Cayenne, Apache, the Apache feather logo, and the Apache Cayenne project logo are trademarks of The Apache Software Foundation.
            <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy policy</a>.
            <img class="d-block  mx-auto mt-2" src="/img/logo_mono-3302daa3cf.svg" alt="Apache Cayenne" />
        </p>
    </div>
</footer>
    
    </body>
</html>
